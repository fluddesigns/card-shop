<!DOCTYPE html><html lang="en"><head><title>Trade</title><meta name="viewport" content="width=device-width, initial-scale=1.0"><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"><style>body{background:#f0f2f5;height:100vh;overflow:hidden;display:flex;flex-direction:column}.trade-container{flex:1;display:flex}.trade-side{flex:1;display:flex;flex-direction:column;padding:10px;border-right:1px solid #dee2e6}.inventory-list{flex:1;overflow-y:auto;background:white;border:1px solid #ced4da;margin-bottom:10px}.cart-list{height:30%;overflow-y:auto;background:#e9ecef;border:1px solid #ced4da;padding:5px}.item-row{padding:5px;border-bottom:1px solid #eee;cursor:pointer;display:flex;justify-content:space-between}.item-row:hover{background:#f8f9fa}.diff-bar{text-align:center;padding:10px;font-weight:bold;background:#fff3cd;color:#856404}</style></head><body><nav class="navbar navbar-dark bg-dark px-3"><span class="navbar-brand mb-0 h1"> Trade</span><a href="{{ url_for('index') }}" class="btn btn-sm btn-outline-light">Exit</a></nav><div class="diff-bar" id="diffDisplay">Diff: .00</div><div class="trade-container"><div class="trade-side"><select class="form-select mb-2" id="userSelect1" onchange="loadInventory(1)"><option value="">Trader A...</option>{% for user in users %}<option value="{{ user.username }}">{{ user.username }}</option>{% endfor %}</select><div class="inventory-list" id="invList1"></div><div class="cart-list" id="cart1"></div><div class="text-center fw-bold" id="total1">.00</div></div><div class="trade-side" style="border-right:none"><select class="form-select mb-2" id="userSelect2" onchange="loadInventory(2)"><option value="">Trader B...</option>{% for user in users %}<option value="{{ user.username }}">{{ user.username }}</option>{% endfor %}</select><div class="inventory-list" id="invList2"></div><div class="cart-list" id="cart2"></div><div class="text-center fw-bold" id="total2">.00</div></div></div><script>let invs={1:[],2:[]},carts={1:[],2:[]};async function loadInventory(s){const u=document.getElementById(userSelect).value;if(!u)return;const r=await fetch(/api/inventory/);invs[s]=await r.json();renderInv(s)}function renderInv(s){document.getElementById(invList).innerHTML=invs[s].map(c=><div class="item-row" onclick="add(,)"><span></span><span>UTF8{c.price}</span></div>).join('')}function add(s,id){const c=invs[s].find(x=>x.id===id);carts[s].push(c);renderCart(s);update()}function renderCart(s){document.getElementById(cart).innerHTML=carts[s].map((c,i)=><div class="item-row" onclick="rem(,)"><span></span><span>UTF8{c.price}</span></div>).join('')}function rem(s,i){carts[s].splice(i,1);renderCart(s);update()}function update(){const t1=carts[1].reduce((a,b)=>a+b.price,0),t2=carts[2].reduce((a,b)=>a+b.price,0);document.getElementById('total1').innerText='$'+t1.toFixed(2);document.getElementById('total2').innerText='$'+t2.toFixed(2);document.getElementById('diffDisplay').innerText=Diff: UTF8{(t1-t2).toFixed(2)}}</script></body></html>
